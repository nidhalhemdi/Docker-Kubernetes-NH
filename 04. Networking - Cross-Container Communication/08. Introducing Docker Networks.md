# **Introducing Docker Networks ‚Äî Elegant Container-to-Container Communication**

- Explaining how to properly connect multiple containers (Node API ‚Üî MongoDB) using **Docker Networks**, which is the *recommended and scalable approach*.

---

# üåê **Why Docker Networks?**

Containers are **isolated** by default and cannot communicate.

You *can* manually use internal IP addresses, but that is:
‚ùå inconvenient
‚ùå unstable (IP changes if container restarts)
‚ùå not scalable

**Docker Networks solve this elegantly**:

> Containers in the same network can communicate by using each other‚Äôs **container names** instead of IPs.

---

# üõ†Ô∏è Steps to Use Docker Networks

## **1. Stop existing containers**

```bash
docker stop favorites
docker stop mongodb
```

(Or remove them if needed using `docker container prune`.)

---

## **2. Create a new network**

Docker does **not** auto-create networks.
You must create one manually:

```bash
docker network create favorites-net
```

Check networks:

```bash
docker network ls
```

You will see:

```
favorites-net
bridge
host
none
...
```

---

## **3. Run MongoDB inside the network**

```bash
docker run -d --name mongodb --network favorites-net mongo
```

Notice:
‚úî No `-p` needed
Because we are not accessing MongoDB from outside ‚Äî only another container will access it internally.

---

## **4. Update Node.js connection string**

Instead of using an IP address:

```js
mongoose.connect('mongodb://172.17.0.2:27017/some-db');
```

Use the **container name**:

```js
mongoose.connect('mongodb://mongodb:27017/some-db');
```

**Docker resolves `mongodb` ‚Üí correct container IP automatically**, as long as both containers are in the same network.

---

## **5. Rebuild Node.js image**

```bash
docker build -t favorites-node .
```

---

## **6. Run the Node.js container in the same network**

```bash
docker run -d --rm --name favorites \
  -p 3000:3000 \
  --network favorites-net \
  favorites-node
```

---

# üß™ **Testing**

* Both containers stay up (good sign)
* Application logs show only a warning, **no connection errors**
* `GET /favorites` returns an empty array (fresh DB)
* `POST /favorites` works and the data persists inside MongoDB

‚úî Communication confirmed
‚úî No IP lookup needed
‚úî No hardcoding
‚úî Production-friendly

---

# ‚ö†Ô∏è Important Notes

### **1. Port publishing (`-p`) is NOT required for container-to-container communication**

Only necessary when connecting **from outside Docker** (e.g., browser, Postman).

### **2. Container names act like domain names**

Example:

```
mongodb ‚Üí resolves to 172.18.0.x
```

### **3. Networks are the standard way for multi-container setups**

Manual IP lookup is just a learning step.