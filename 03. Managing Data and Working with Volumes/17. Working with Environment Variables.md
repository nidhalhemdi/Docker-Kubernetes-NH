# **Environment Variables & `.env` Files in Docker â€” Summary**

Docker allows two kinds of dynamic data:

1. **Build-time arguments (`ARG`)**
2. **Runtime environment variables (`ENV`)**

This lecture focuses on **environment variables**.

---

# ğŸ”§ **What are Environment Variables?**

Environment variables are values you inject into a running application **from outside**.

Useful for:

* Changing ports
* API keys
* Modes (dev / prod)
* Feature flags
* Configurations

You do **not** want to hard-code these into the code or the image.

Most languagesâ€”including Node.jsâ€”allow accessing env variables.

In Node, you use:

```js
process.env.PORT
```

---

# ğŸ³ **Defining Environment Variables in a Dockerfile**

Inside the Dockerfile, use:

```
ENV PORT=80
```

This:

* Announces that `PORT` exists
* Gives it a default value
* Makes it available to the entire container + your app

You can also reference it in other Docker instructions (like `EXPOSE`):

```
EXPOSE $PORT
```

(`$PORT` = use the variable value)

---

# ğŸš€ **Using environment variables during `docker run`**

You can override the default `PORT` when you run a container.

### **Option 1 â€” Set single env variable**

```
docker run -p 8000:8000 --env PORT=8000 myimage
```

Short version:

```
docker run -p 8000:8000 -e PORT=8000 myimage
```

### **Option 2 â€” Set multiple**

Use multiple `-e`:

```
docker run -e PORT=8000 -e MODE=development myimage
```

---

# ğŸ“ **Using `.env` files**

You can store environment variables in a file named `.env`:

#### Example `.env`

```
PORT=8000
API_KEY=123abc
```

Then run:

```
docker run --env-file ./.env myimage
```

Benefits:

* Cleaner command line
* Easier to change values
* Reusable between runs
* No need to rebuild the image

---

# ğŸ“ **Example: Using PORT environment variable in Node.js**

### **server.js**

```js
const port = process.env.PORT || 80;
app.listen(port);
```

### **Dockerfile**

```
ENV PORT=80
EXPOSE $PORT
```

### **Run with a custom port**

```
docker run -p 8000:8000 -e PORT=8000 myimage
```

---

# ğŸ¯ **WHY this is useful**

* You don't need to rebuild images to change behavior.
* You can run the **same image** in:

  * Development
  * Testing
  * Production
    simply by changing env variables.
* Keeps sensitive data *out* of the Dockerfile.
* Allows flexible configuration.

---

# ğŸ§  **Key Concepts (short)**

| Concept         | Purpose                         | Set Where?                      |
| --------------- | ------------------------------- | ------------------------------- |
| **ENV**         | Variables for runtime           | Dockerfile and/or `docker run`  |
| **ARG**         | Variables for image build stage | `docker build --build-arg`      |
| **`.env` file** | Stores multiple env vars        | Used in `docker run --env-file` |

---

# ğŸ”‘ **Remember**

* `ENV` = runtime inside container
* `ARG` = build time only
* `.env` files = clean configuration
* `-e` or `--env` = quick inline env variables
* You must update your port mapping (`-p`) to match the internal PORT you set.
