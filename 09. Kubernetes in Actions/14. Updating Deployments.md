# **Updating Deployments â€” Summary**

This lecture explains how to update your application code inside a running Kubernetes Deployment â€” and how Kubernetes handles rolling updates behind the scenes.

---

# 1ï¸âƒ£ **Step 1: Change Your Code â†’ Rebuild Docker Image**

When you update your application code:

* You must **rebuild** the Docker image
* Because the source code *lives inside the image*

Example:

```
docker build -t nidhalhaamdii/kub-first-app .
```

But for updates to work properly, you will need to **version the image** (see step 4).

---

# 2ï¸âƒ£ **Step 2: Push the Updated Image**

Since the Deployment pulls images from **Docker Hub**:

```
docker push nidhalhaamdii/kub-first-app
```

(or the versioned tag later)

---

# 3ï¸âƒ£ **Step 3: Use `kubectl set image` to Update the Deployment**

Check the deployment exists:

```
kubectl get deployments
```

Then update it:

```
kubectl set image deployment/first-app kub-first-app=nidhalhaamdii/kub-first-app
```

Structure:

```
kubectl set image deployment/<deployment-name> <container-name>=<new-image>
```

Where:

* `first-app` = Deployment name
* `kub-first-app` = Container name inside the Pod
* `nidhalhaamdii/kub-first-app` = New image

Kubernetes will try to pull the image and restart Pods using it.

---

# 4ï¸âƒ£ **Important: Kubernetes Only Pulls a New Image When the TAG Changes**

If you push a new image **with the same tag**, Kubernetes usually **does not re-download it**.

â¡ï¸ **Solution: Version your images.**

Example:

```
docker build -t nidhalhaamdii/kub-first-app:v2 .
docker push nidhalhaamdii/kub-first-app:v2
```

Then update the deployment using the new tag:

```
kubectl set image deployment/first-app kub-first-app=nidhalhaamdii/kub-first-app:v2
```

Now Kubernetes recognizes that the tag changed â†’ pulls the new version â†’ updates Pods.

---

# 5ï¸âƒ£ **Check the Rollout Status**

Useful command to monitor update progress:

```
kubectl rollout status deployment/first-app
```

Youâ€™ll see:

```
deployment "first-app" successfully rolled out
```

This confirms old Pods have been replaced.

---

# 6ï¸âƒ£ **Verify the Update**

### In the browser:

Youâ€™ll see the new version of your app (after a few seconds).

### In the dashboard:

* Open **Pods** â†’ select a Pod â†’ see the **new image tag**.
* Under **Events**, you can see the new image being pulled.

---

# ğŸ“Œ **Key Takeaways**

* To update your app: **rebuild â†’ push â†’ set new image tag**.
* Kubernetes performs a **rolling update**, replacing old Pods with new ones.
* Always use **versioned image tags** (e.g., `v1`, `v2`, `v3`).
* You can track the update using **rollout status**.
* Kubernetes automatically manages the restart of Pods using the new image.
