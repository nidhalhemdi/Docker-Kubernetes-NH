# **Understanding Persistent Volume Claims (PVCs) in Kubernetes**

You've already created a **Persistent Volume (PV)** ‚Äî that‚Äôs the *storage* available in your cluster.

But a PV *by itself* does nothing until something *claims* it.

That‚Äôs where a **Persistent Volume Claim (PVC)** comes in.

---

# üß© **Why a PVC?**

Think of it like this:

* **PV = a storage unit available for rent**
* **PVC = the rental contract**
* **Pod = the tenant**

PV defines what exists.
PVC says, ‚ÄúI want to use that storage.‚Äù
Pods then attach to the PVC.

This separation gives Kubernetes flexibility and scheduling freedom.

---

# üõ†Ô∏è **What Goes Into a PVC?**

A PVC YAML contains:

### 1. **apiVersion**

```
apiVersion: v1
```

### 2. **kind**

```
kind: PersistentVolumeClaim
```

### 3. **metadata**

Name of the claim:

```
metadata:
  name: host-pvc
```

### 4. **spec**

This is where you define what you want:

#### a) **VolumeName** (optional, direct binding)

```
volumeName: host-pv
```

This explicitly binds this claim to a specific PV by name.

> In real clusters, PVCs often bind *dynamically* using storage classes, not by name, but this manual binding is common for demos.

#### b) **accessModes**

Must match what the PV supports:

```
accessModes:
  - ReadWriteOnce
```

#### c) **resources (requests)**

How much storage you want:

```
resources:
  requests:
    storage: 1Gi
```

This must be *equal or less* than the PV's capacity.

---

# üîó **Connecting the PVC to a Pod**

The PVC alone still does nothing.
Pods must use it via the **volumes** section.

In your *Deployment YAML*:

### Step 1 ‚Äî Replace hostPath with persistentVolumeClaim

```
volumes:
  - name: data-volume
    persistentVolumeClaim:
      claimName: host-pvc
```

### Step 2 ‚Äî Keep your volumeMounts unchanged

```
volumeMounts:
  - mountPath: /app/data
    name: data-volume
```

Your pod now uses *cluster-level storage*, not a private hostPath.

---

# üåê **Key Benefit**

### With PV + PVC:

Your data lives at the cluster level ‚Äî not tied to a single pod.

This becomes **true node independence** *once you switch from hostPath to real storage* (like AWS EFS via CSI).

---

# ‚úîÔ∏è **Final Outcome**

After applying:

```
kubectl apply -f host-pv.yaml
kubectl apply -f host-pvc.yaml
kubectl apply -f deployment.yaml
```

Your app will run normally, but:

* pods can die ‚Üí data stays
* pods can restart ‚Üí same data
* multiple pods can use the same PVC (depending on access mode)
